---
title: "IDK: A Statistical Analysis of Palm Beach County Election Votes in 2000"
author: "Sydney Weisberg and Molly Daniel"
date: "Case Study #1, `r Sys.Date()`"
format: 
  pdf:
    keep-tex: true
    include-in-header: 
       text: |
         \usepackage{fvextra}
         \DefineVerbatimEnvironment{Highlighting}{Verbatim}{breaklines,commandchars=\\\{\}}
         \DefineVerbatimEnvironment{OutputCode}{Verbatim}{breaklines,commandchars=\\\{\}}
    geometry: 
      - left=1in
      - right=1in
      - top=1in
      - bottom=1in
---

```{r, include=FALSE}
library(tidyverse)
library(Sleuth2)
library(kableExtra)
library(broom)

election <- Sleuth2::ex0825

election_wo_pb <- election |> filter(County != "Palm Beach")
```

# Introduction


# Data Description

The election data consists of the numbers of votes for Buchanan and Bush in all 67 counties in Florida. 

```{r, echo=FALSE, message=FALSE, warning-FALSE}
# syd note - I need to go back through this and add captions to these
election_wo_pb |> ggplot(aes(x = Bush2000, y = Buchanan2000)) + geom_point() + ggtitle("Association between votes for Bush and votes for Buchanan.")

election_wo_pb |> ggplot(aes(x = log(Bush2000), y = log(Buchanan2000))) + geom_point() + ggtitle("Transformed Association between votes for Bush and votes for Buchanan.")
```

# Modeling Process

In order to create a model, we first observed a relationship in the scatter plot showing the votes for Buchanan and Bush in each of the Florida counties. From this, we noticed data clustering occurring in the bottom left corner of the scatter plot. In order to expand the scale, we applied a log transformation to both the Buchanan and Bush votes, revealing a multiplicative relationship between the two.

Let $buchanan_i$ denote the number of votes cast for Buchanan in county $i$ and $bush_i$ denote the number of votes cast for Bush in Florida county $i$ during the U.S. presidential election of November 7, 2000.
Our final linear regression model for the mean is $E[log(buchanan_i) | log(bush_i)] = \beta_0 + \beta_1\log(bush_i).$ We fit our sample data to this model, and found estimates for the coefficients. 

```{r echo=FALSE}
both_transformed <- lm(log(Buchanan2000) ~ log(Bush2000), data = election_wo_pb)
both_transformed_table <- summary(both_transformed)$coefficients

both_transformed_table |> kbl(col.names = c("Estimate", "Std. Error", "t value", "Pr(>|t|)"), align = "c", booktabs = T, linesep="", digits = c(2, 2, 2, 4)) |> kable_classic(full_width = F, latex_options = c("HOLD_position"))
```

Our sample intercept, $\hat{\beta_0}$, is -2.34149 with a standard error of 0.35442. Our sample slope, $\hat{\beta_1}$, is 0.73096 with a standard error of 0.03597. Both coefficients have a p value less than 0.05, making them statistically significant. So our fitted model is $\widehat{\log(buchanan_i)} = -2.34149 + 0.73096\log(bush_i).$

Point Estimate = e^6.384143 = 592.376848042

Prediction Interval = (e^5.524656, e^7.24363) = (250.8, 1399.164)

This means that we are 95% confident that the number of votes cast for Buchanan in the U.S. presidential election of November 7, 2000 when the number of votes cast for Bush is 152846 (the reported number of votes for Bush in Palm Beach county) is between 250.8 and 1399.164 votes.

# Conclusion

Since the 3407 votes for Buchanan in Palm Beach County in the 2000 election falls outside of our prediction interval of 250.8 to 1399.164 where Bush receives 15,2846 votes, we can conclude that it is likely that there is some external factor impacting the votes of the residents in Palm Beach. One limitation of this analysis is the lack of information regarding the sociopolitical climate of Palm Beach County in 2020. We do not know the demographic breakdown of the county. If there were a higher percentage of centrists who would vote for a member of the Reform Party in 2020 then that could explain the abnormal amount of Buchanan votes. Additionally, we don't know what campaigning was like in Palm Beach County. There could have been additional campaigns for Buchanan there that caused a vote increase particularly in that county. Based on the assumption that some of the votes cast for Buchanan in Palm Beach were actually intended to be votes for Gore, we make a generalization that there are more Democratic voters in Palm Beach County than represented in our data. Without the cultural knowledge of the environment where the data comes from, we can't be fully confident that our model is a good fit for the data. 

# R Appendix

```{r, message=FALSE, warning=FALSE}
# Importing relevant packages
library(tidyverse)
library(Sleuth2)
library(broom)
library(kableExtra) 

# Importing election data from the textbook
election <- Sleuth2::ex0825

# Removing the extreme Palm Beach observation
election_wo_pb <- election |> filter(County != "Palm Beach")

# Displaying an untransformed scatter plot between Bush and Buchanan votes
election_wo_pb |> ggplot(aes(x = Bush2000, y = Buchanan2000)) + geom_point() + ggtitle("Association between votes for Bush and votes for Buchanan.")

# Displaying a doubly transformed scatter plot between Bush and Buchanan votes
election_wo_pb |> ggplot(aes(x = log(Bush2000), y = log(Buchanan2000))) + geom_point() + ggtitle("Transformed Association between votes for Bush and votes for Buchanan.")

# Testing transformations to determine the best fit for the model

# Untransformed model
untransformed <- lm(Buchanan2000 ~ Bush2000, data = election_wo_pb)
plot(untransformed)

# Model with a logarithmic explanatory variable transformation
xtransformed <- lm(Buchanan2000 ~ log(Bush2000), data = election_wo_pb)
plot(xtransformed)

# Model with a logarithmic response variable transformation
ytransformed <- lm(log(Buchanan2000) ~ Bush2000, data = election_wo_pb)
plot(ytransformed)

# Model with a logarithmic explanatory and response variable transformation
both_transformed <- lm(log(Buchanan2000) ~ log(Bush2000), data = election_wo_pb)

# Getting the coefficients for the doubly transformed model
both_transformed_table <- summary(both_transformed)$coefficients

# Creating a visible, clean table to display the coefficients from the doubly transformed model
both_transformed_table |> kbl(col.names = c("Estimate", "Std. Error", "t value", "Pr(>|t|)"), align = "c", booktabs = T, linesep="", digits = c(2, 2, 2, 4)) |> kable_classic(full_width = F, latex_options = c("HOLD_position"))

summary(both_transformed)

# Creating a prediction interval
predicted_palm_beach = data.frame(Bush2000 = 152846)
both_transformed |> augment(newdata = predicted_palm_beach, interval = "prediction", conf.level = 0.95)
```